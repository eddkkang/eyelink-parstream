extends ../layout-type01
block style
  link(rel='stylesheet', href='/assets/leaflet/dc.css')
  link(rel='stylesheet', href='/stylesheets/style.css')  
  link(type='text/css', rel='stylesheet', href='/assets/sample/style/bigscatterchart.css') 
  link(type='text/css', rel='stylesheet', href='/assets/sample/style/jquery-ui.css')  
  link(href='/assets/sample/style/dashboard_main.css', rel='stylesheet') 
  link(rel='stylesheet', href='/scripts/d3_timeseries.css')    
  style.
    td {
      text-align : center;
    }
block script
  script(type='text/javascript', src='/assets/annie/js/d3_dc.js')
  script(type='text/javascript', src='/assets/annie/js/crossfilter.js')
  script(type='text/javascript', src='/assets/annie/js/dc.js')
  script(type='text/javascript', src='/assets/annie/js/colorbrewer.js')  
  script(type='text/javascript', src='/socket.io/socket.io.js')
  script(type='text/javascript', src="/scripts/util.js")        
  script(type='text/javascript', src="/scripts/d3_timeseries_3.js")
  script(type='text/javascript', src='/assets/sample/js/modernizr.js')
  script(type='text/javascript', src='/assets/sample/js/underscore-min.js')  
  script(type='text/javascript', src='/assets/sample/js/jquery.Class.js')
  script(type='text/javascript', src='/assets/sample/js/jquery.dragToSelect.js')
  script(type='text/javascript', src='/assets/sample/js/jquery.BigScatterChart.js')  
  script(src='/assets/sample/js/d3.chart.min.js')
  script(src='/scripts/bottleneck.js', type='text/javascript')    
  script.
    $(document).ready(function(e) {
      var dateFormat = 'YYYY-MM-DD';
      $('#date').val(moment().format(dateFormat));               
      var server = $("#server").val();  
      var selected = {CPU : '', MEMORY : '', SERVICE : ''};
      var range = 1;
      $('input[name="selected"]').on('click change', function(e) {
        var values = { 'CPU70' : ["CPU_70","CPU_80","CPU_90","CPU_100"], 'CPU80' : ["CPU_80","CPU_90","CPU_100"],
          'CPU90' : ["CPU_90","CPU_100"], 'CPU100' : ["CPU_100"], 'MEMORY70' : ["MEMORY_70","MEMORY_80","MEMORY_90","MEMORY_100"], 
          'MEMORY80' : ["MEMORY_80","MEMORY_90","MEMORY_100"], 'MEMORY90' : ["MEMORY_90","MEMORY_100"], 'MEMORY100' : ["MEMORY_100"]}       
        selected[e.target.id] = values[e.target.value];        
        console.log(selected);        
      });
      $('input[name="time"]').on('click change', function(e) {
        var time = {'2min' : 1, '4min' : 2, '10min' : 5};        
        range = time[e.target.id];     
        if(stamp != ''){
          getChartData(range);
        }        
      });      
      $( "#btn_search" ).click(function() {  
        server = $("select[name=server]").val(); 
        getData(server, selected);
      });      
    });
block content    
  input#indexs(type='hidden', name='indexs', value=indexs)
  input#server(type='hidden', name='server', value=server)
  .container-fluid
    .page-content
      // BEGIN BREADCRUMBS
      .breadcrumbs
        h1 Bottleneck
        ol.breadcrumb
          li
            a(href='#') Home
          li
            a(href='#') Dashboard
          li.active Bottleneck
      .row        
        .col-md-12      
          .portlet.light.bordered
            .portlet-title
              .caption.font-dark.col-md-8
                span.caption-subject.bold.uppercase 부하유형 선택              
            .portlet-body(style='height:140px')                    
              .col-md-2
              .col-md-3
                table
                  tr(style='height:45px')
                    th
                      label.control-label.col-md-12 Server  
                    th
                      select#server.form-control.input-small.select2me.form-md-line-input(name='server' style='width:120px')
                        each data in agent                           
                          #{server}
                            if data.name==server
                             option(value='', selected='selected') #{data.name}
                            else
                             option #{data.name}                               
                  tr(style='height:45px')
                    th
                      label.control-label.col-md-12 Date
                    th
                      .input-group.input-large.date-picker.input-daterange(data-date='2017-01-01', data-date-format='yyyy-mm-dd')
                        input#date.form-control(type='text', name='from' value='' style='width:140px')                   
              .col-md-4
                table
                  tr(style='height:45px')        
                    th                
                      label.btn-transparent.control-label.col-md-12  CPU
                    th
                      .btn-group.actions(data-toggle='buttons')
                        label.btn.btn-default
                          input.toggle(type='radio' id='CPU' name='selected' value='CPU70')
                          |  70%
                        label.btn.btn-default
                          input.toggle(type='radio' id='CPU' name='selected' value='CPU80')
                          |  80%
                        label.btn.btn-default
                          input.toggle(type='radio' id='CPU' name='selected' value='CPU90')
                          |  90%
                        label.btn.btn-default
                          input.toggle(type='radio' id='CPU' name='selected' value='CPU100')
                          |  100%    
                    tr(style='height:45px')                    
                      th
                        label.btn-transparent.control-label.col-md-12  MEMORY
                      th
                        .btn-group.actions(data-toggle='buttons')
                          label.btn.btn-default
                            input.toggle(type='radio' id='MEMORY' name='selected' value='MEMORY70')
                            |  70%
                          label.btn.btn-default
                            input.toggle(type='radio' id='MEMORY' name='selected' value='MEMORY80')
                            |  80%
                          label.btn.btn-default
                            input.toggle(type='radio' id='MEMORY' name='selected' value='MEMORY90')
                            |  90%
                          label.btn.btn-default
                            input.toggle(type='radio' id='MEMORY' name='selected' value='100')
                            |  100%
                    tr(style='height:45px')
                      th
                        label.btn-transparent.control-label.col-md-12  SERVICE
                      th
                        .btn-group.actions(data-toggle='buttons')                    
                          label.btn.btn-default
                            input.toggle(type='radio' id='SERVICE' name='selected' value='5')
                            |  5s
                          label.btn.btn-default
                            input.toggle(type='radio' id='SERVICE' name='selected' value='slow')
                            |  Slow
                          label.btn.btn-default
                            input.toggle(type='radio' id='SERVICE0' name='selected' value='error')
                            |  Error              
              .col-md-2.form-inline
                button#btn_search.btn.blue
                  i.fa.fa-search  Search
      .row
        .col-md-4
          // BEGIN PORTLET
          .portlet.light.bordered
            .portlet-title
              .caption.caption-md.font-blue.col-md-6
                i.icon-bar-chart.theme-font.hide
                span.caption-subject.theme-font.bold.uppercase Bottleneck List                                
                span.caption-helper.hide description
                form.form-horizontal.form-bordered(onsubmit="return false;") 
            .portlet-body(style='height:1005px')
              .scroller(style='height: 990px;', data-always-visible='1', data-rail-visible1='0', data-handle-color='#D7DCE2')
                #list
        .col-md-8      
          .portlet.light.bordered
            .portlet-title
              .caption.font-dark
                span.caption-subject.bold.uppercase Detail
            .portlet-body(style='height:220px')      
              #detail   
        .col-md-8
          .portlet.light.bordered
            .portlet-title.smap-chart-title
              .caption
                span.caption-subject.bold
                  | Chart
              .btn-group.actions(data-toggle='buttons')
                label.btn.btn-default
                  input.toggle(type='radio' id='2min' name='time')
                  |  2min
                label.btn.btn-default
                  input.toggle(type='radio' id='4min' name='time')
                  |  4min
                label.btn.btn-default
                  input.toggle(type='radio' id='10min' name='time')
                  |  10min
            .portlet-body(style='height:675px')
              .row
                .col-md-7.smap-chart
                  p Access Log Response Data
                  #chart1
                .col-md-5.smap-chart
                  p Count by All
                  #test                  
              .portlet-body.smap-chart-box
                .row(style='height:')
                  .col-md-4.smap-chart(id='')
                    p JVM/SYSTEM CPU USAGE Cpu Usage(%)
                    #ts-chart01
                  .col-md-4.smap-chart
                    p HEAP USAGE Memory(bytes)
                    #ts-chart02
                  .col-md-4.smap-chart(id='')
                    p PERMGEN USAGE Memory(bytes)
                    #ts-chart03                              
        p.copyright Copyright M2U Technology All rights reserved.       
    a.go2top(href='#index')
        i.icon-arrow-up

